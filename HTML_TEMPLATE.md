# PML 4.0.0 HTML Template

Info on the HTML template used by PMLC, for CSS developers.


-----

**Table of Contents**

<!-- MarkdownTOC autolink="true" bracket="round" autoanchor="false" lowercase="only_ascii" uri_encoding="true" levels="1,2,3" -->

- [About](#about)
- [Template Structure](#template-structure)
- [The Table of Contents](#the-table-of-contents)
- [General Considerations](#general-considerations)

<!-- /MarkdownTOC -->

-----

# About

Since PML templates are still in their early stage, they aren't well documented.

This document attempts to collect some useful information to guide CSS development.

The [PML Nodes Reference Manual] provides examples of the HTML output of individual nodes, which is useful when trying to style PML nodes which result in complex HTML structures.


# Template Structure

Here's the overall structure of the HTML output, somewhat simplified and adapted for the goal at hand, with HTML comments added to further clarify where PMLC injects custom assets on demand. Since end user can customize the template header and footer, I'll split the template in three chunks.

Here's the default template header chunk, as defined in `default_html_header_template.txt` (customizable), using the `[highlighter highlightjs]` option to show where JavaScript dependencies are injected:

```html
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="generator" content="PML {{PML_version}} (www.pml-lang.dev)" />
        <title>Document Title</title>
        <!-- CSS stylesheets -->
        <link rel="stylesheet" href="css/pml-default.css">
        <link rel="stylesheet" href="css/pml-print-default.css" media="print">
        <link rel="stylesheet" href="css/https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/styles/default.min.css">
    </head>
    <body>
        <!-- JavaScript resources -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/highlight.min.js"></script>
        <script>hljs.highlightAll();</script>
```

Here's the document body, as generated by PMLC (not customizable):

```html
        <div class="pml-doc-wrapper">
            <header class="pml-doc-header">
            </header>
                <div class="pml-doc-content">
                    <aside class="pml-doc-left">
                        <!-- ToC if positioned left -->
                    </aside>
                    <article id="doc__" class="pml-doc-text">
                        <h1 class="pml-doc-title">Document Title</h1>
                        <h1 class="pml-doc-title">Document Subtitle</h1>
                        <!-- ToC if positioned top -->
                        <!-- ... DOCUMENT CONTENTS ... -->
                    </article>
                    <aside class="pml-doc-right">
                    </aside>
                </div>
                <footer class="pml-doc-footer">
                </footer>
            </div>
        </div>
```

And here's the template footer chunk, as defined in `default_html_footer_template.txt` (customizable):

```html
    </body>
</html>
```

> [!NOTE]
>
> - The `<header>` and `<footer>` are unused, and their contents can't be controlled via custom templates, since these tags fall outside of the user templates boundaries.
> - A `[doc [subtitle` node is rendered as an `<h1>` heading, so a document with both title and subtitle will have two consecutive Level-1 headings. The documentation is unclear whether document subtitles are supported or not, but PMLC does handle them without error, although it adds the `pml-doc-title` class to both, whereas section subtitles (i.e. "chapters" subtitles) are classed as `pml-chapter-subtitle`.
> - The right-hand `<aside>` (class `pml-doc-right`) doesn't have any apparent use right now, since the `TOC_position` parameter only accepts `left`, `top` and `none` as values.


# The Table of Contents

The ToC, if present, can be either positioned to the `left` (default) or on `top` of the document, or omitted via the `none` option.

When the ToC is positioned left, it will be injected within the `<aside class="pml-doc-left">` tag, whereas when top-positioned it will be injected right after the document title/subtitle headings, within `<article>`.

The generated ToC has a rather baroque structure:

```html
<nav class="pml-toc">
    <h2 class="pml-toc-title">Table of Contents</h2>
    <div class="pml-toc-tree" id="TOCTree">
        <ul>
            <li class="pml-toc-leaf-node"><a href="#ch__1">Chap 1</a></li>
            <li class="pml-toc-branch-node">
                <details>
                    <summary><a href="#ch__2">Chap 2</a></summary>
                    <ul>
                        <li class="pml-toc-leaf-node"><a href="#ch__3">Sub Chap 2.1</a></li>
                        <li class="pml-toc-leaf-node"><a href="#ch__4">Sub Chap 2.2</a></li>
                    </ul>
                </details>
            </li>
        </ul>
    </div>
</nav>
```

where branch and leaf entries are distinguished by the `.pml-toc-branch-node` and `.pml-toc-leaf-node` classes on `<li>`, respectively, and the former exploits the [`<details>` disclosure element][<details>] and `<summary>` tags to provide a clickable folding tree structure without resorting to JavaScript.


# General Considerations

The current template doesn't exactly lend itself to support custom CSS stylesheets, mostly because of all the generated tags are given just classes, even when IDs would have been a better choice.

If we take the [SMACSS] approach to stylesheets design, we immediately notice that unique layout elements like the doc-wrapper div, the header, footer, right- and left-sidebars would have benefited from a unique identifier to improve the CSS [specificity] of our [Layout Rules], and the left and sidebars would have also benefited from a commonly shared class for rules that apply to both (e.g. when they are symmetrical).

The ToC, according to SMACSS, falls under [Module Rules], so it's OK to refer to it via a class, but having PMLC inject an extra class for its position — e.g. `class="pml-toc left"` — might have allowed better CSS rules to target between a left- and top-positioned ToC, i.e. rather than having to rely on some parent tag, like:

```css
.pml-doc-left > .pml-toc {
    /* Left ToC rules  */
}

.pml-doc-text > .pml-toc {
    /* Top ToC rules  */
}

```

The problem with the above rules is that they depend on a specific HTML structure, which might not be present in custom HTML templates (i.e. when users will have full control over the template), whereas the proposed additional classes don't:

```css
.pml-toc {
    /* Shared ToC rules  */
}

.pml-toc.left {
    /* Left ToC rules  */
}

.pml-toc.top {
    /* Top ToC rules  */
}
```

and, as the example above illustrates, this approach not only improves CSS [specificity] but also leads to more elegant and readable stylesheets.

Although it's impossible to predict all the possible needs of every stylesheet designer, PMLC should at least provide smart HTML elements coverage when it comes to its natively injected IDs and classes, striking a good balance between flexibility and common use cases expectations.

<!-----------------------------------------------------------------------------
                               REFERENCE LINKS
------------------------------------------------------------------------------>

[PML Nodes Reference Manual]: https://pml-lang.dev/docs/reference_manual/index.html

<!-- MDN Web Docs -->

[<details>]: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/details "MDN Web Docs » References » HTML » <details>: The Details disclosure element"
[Specificity]: https://developer.mozilla.org/en-US/docs/Web/CSS/Specificity "MDN Web Docs » References » CSS » Specificity"
[Using CSS nesting]: https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_nesting/Using_CSS_nesting "MDN Web Docs » CSS » CSS nesting » Using CSS nesting"

<!-- SMACSS -->

[SMACSS]: https://smacss.com/ "SMACSS website and online book"
[Layout Rules]: https://smacss.com/book/type-layout/ "SMACSS » Layout Rules"
[Module Rules]: https://smacss.com/book/type-module/ "SMACSS » Module Rules"

<!-- EOF -->
